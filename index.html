<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<title>ESPORTS CHALLENGE HSWP 2026</title>

<style>
/* ================= BASE ================= */
body{
  font-family:Arial,Helvetica,sans-serif;
  background:radial-gradient(circle at top,#333,#000);
  margin:0;
  padding:16px;
}
h1{
  text-align:center;
  color:#fff;
  margin:0 0 14px;
  font-size:22px;
}

/* ================= LAYOUT ================= */
.container{
  display:grid;
  grid-template-columns:1.2fr 1fr;
  gap:16px;
}
.card{
  background:rgba(255,255,255,.9);
  backdrop-filter:blur(14px);
  border-radius:22px;
  padding:16px;
  box-shadow:0 10px 26px rgba(0,0,0,.35);
}

/* ================= HEADER ================= */
.card h3{
  margin:0 0 6px;
  font-size:16px;
}
.map-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:8px;
  margin-bottom:6px;
}

/* ================= TABS ================= */
.tabs button{
  border:none;
  padding:6px 14px;
  border-radius:999px;
  background:#eee;
  cursor:pointer;
  font-weight:600;
  font-size:12px;
}
.tabs .active{background:#d6b15f}

/* ================= BUTTON ================= */
.btn{
  border:none;
  padding:6px 14px;
  border-radius:999px;
  color:#fff;
  cursor:pointer;
  font-weight:600;
  font-size:12px;
}
.btn-lock{background:#2ecc71}
.btn-unlock{background:#777}
.btn-reset{background:#e74c3c}
.btn-export{background:#3498db}
.btn-import{background:#9b59b6}
.map-actions .btn{margin-left:4px}

/* ================= TABLE ================= */
table{
  width:100%;
  border-collapse:collapse;
  margin-top:8px;
}
th,td{
  border-bottom:1px solid rgba(0,0,0,.12);
  padding:6px;
  text-align:center;
  font-size:12px;
  line-height:1.2;
}
td.team{text-align:left}

/* ================= DRAG ================= */
.drag-row{
  transition:
    background .15s ease,
    transform .25s cubic-bezier(.2,.8,.3,1);
}
.drag-row.dragging{
  background:rgba(214,177,95,.35);
  opacity:.55;
}
.drag-row.drag-over{
  background:rgba(214,177,95,.25);
}
.drag-row.drop-animate{
  animation:dropSnap .28s ease;
}
@keyframes dropSnap{
  0%{transform:scale(.96)}
  100%{transform:scale(1)}
}
.drag-handle{
  cursor:grab;
  font-size:15px;
  color:#777;
  user-select:none;
}
.drag-handle.disabled{
  cursor:not-allowed;
  opacity:.4;
}

/* ================= BADGE ================= */
.badge{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:4px 12px;
  border-radius:999px;
  font-size:11px;
  font-weight:600;
}
.badge.wwcd{background:#d6b15f;color:#000}
.badge.kill{background:#e3c77a;color:#000}
.kill-plain{color:#555;font-weight:600}

/* ================= POPUP ================= */
.popup{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.55);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:999;
}
.popup-box{
  background:#fff;
  border-radius:18px;
  padding:16px;
}
.kill-grid{
  display:grid;
  grid-template-columns:repeat(5,48px);
  gap:6px;
}
.kill-grid div{
  border:1px solid #ccc;
  padding:8px;
  text-align:center;
  cursor:pointer;
  border-radius:8px;
  font-size:12px;
}
.kill-grid .active{
  background:#d6b15f;
  font-weight:bold;
}
.popup-actions{
  text-align:right;
  margin-top:10px;
}
</style>
</head>

<body>

<h1>ESPORTS CHALLENGE HSWP 2026</h1>

<div class="container">

<!-- MAP STANDING -->
<div class="card">
<h3>MAP STANDING</h3>

<div class="map-header">
  <div class="tabs">
    <button id="tab-erangel" onclick="switchMap('erangel')">Erangel</button>
    <button id="tab-miramar" onclick="switchMap('miramar')">Miramar</button>
    <button id="tab-rondo" onclick="switchMap('rondo')">Rondo</button>
  </div>

  <div class="map-actions">
    <button id="lockBtn" class="btn btn-lock" onclick="toggleLock()">LOCK</button>
    <button class="btn btn-reset" onclick="resetMap()">RESET</button>
    <button class="btn btn-export" onclick="exportData()">EXPORT</button>
    <button class="btn btn-import" onclick="importData()">IMPORT</button>
    <input type="file" id="importFile" hidden accept=".json">
  </div>
</div>

<table>
<thead>
<tr>
  <th>No</th>
  <th style="text-align:left">Team</th>
  <th>WWCD</th>
  <th>Place</th>
  <th>Kill</th>
  <th>Total</th>
</tr>
</thead>
<tbody id="mapTable"></tbody>
</table>
</div>

<!-- ALL STANDING -->
<div class="card">
<h3>ALL STANDING</h3>
<table>
<thead>
<tr>
  <th>No</th>
  <th style="text-align:left">Team</th>
  <th>WWCD</th>
  <th>Place</th>
  <th>Kill</th>
  <th>Total</th>
</tr>
</thead>
<tbody id="allTable"></tbody>
</table>
</div>

</div>

<!-- KILL POPUP -->
<div class="popup" id="killPopup">
 <div class="popup-box">
  <h4>Pilih Kill</h4>
  <div class="kill-grid" id="killGrid"></div>
  <div class="popup-actions">
    <button class="btn btn-reset" onclick="closeKill()">Cancel</button>
    <button class="btn btn-lock" onclick="saveKill()">Save</button>
  </div>
 </div>
</div>

<script>
/* ================= DATA ================= */
const teams=[
 "OL","Zentra","JURNEE 52","HEe ESPORT","AING BALANG","MANTARAY GIANT",
 "SolJar","Yelnats","Martabak Esport","THE RED X","SANTAi KiLLERs",
 "TOP PANDA","ROBOX","DND","FAM | United","REDBULL 26 ESPORTS"
];
const maps=["erangel","miramar","rondo"];
const point=p=>[10,6,5,4,3,2,1,1][p]||0;

/* ================= STATE ================= */
let state=JSON.parse(localStorage.getItem("hswp"))||{
 currentMap:"erangel",
 maps:{
  erangel:{locked:false,order:[...teams],kill:{}},
  miramar:{locked:false,order:[...teams],kill:{}},
  rondo:{locked:false,order:[...teams],kill:{}}
 }
};
maps.forEach(m=>teams.forEach(t=>{
 if(state.maps[m].kill[t]===undefined) state.maps[m].kill[t]=null;
}));
function save(){localStorage.setItem("hswp",JSON.stringify(state));}

/* ================= MAP ================= */
function switchMap(m){
 state.currentMap=m;
 document.querySelectorAll(".tabs button").forEach(b=>b.classList.remove("active"));
 document.getElementById("tab-"+m).classList.add("active");
 renderMap();
}

/* ================= LOCK ================= */
function toggleLock(){
 const map=state.maps[state.currentMap];
 if(!confirm(map.locked?"Buka MODE EDIT?":"Bekukan data map ini?"))return;
 map.locked=!map.locked;
 save(); renderMap();
}

/* ================= RESET ================= */
function resetMap(){
 const map=state.maps[state.currentMap];
 if(map.locked){alert("UNLOCK dahulu");return;}
 if(!confirm("Reset map ini?"))return;
 map.order=[...teams];
 teams.forEach(t=>map.kill[t]=null);
 save(); renderMap();
}

/* ================= DRAG & DROP ================= */
let dragFrom=null;
function enableDrag(){
 const map=state.maps[state.currentMap];
 document.querySelectorAll("#mapTable tr").forEach((row,i)=>{
   row.draggable=!map.locked;
   row.classList.remove("dragging","drag-over");

   row.addEventListener("dragstart",e=>{
     if(map.locked)return;
     dragFrom=i;
     row.classList.add("dragging");
     e.dataTransfer.effectAllowed="move";
   });

   row.addEventListener("dragover",e=>{
     if(map.locked)return;
     e.preventDefault();
     row.classList.add("drag-over");
   });

   row.addEventListener("dragleave",()=>{
     row.classList.remove("drag-over");
   });

   row.addEventListener("drop",e=>{
     if(map.locked)return;
     e.preventDefault();
     row.classList.remove("drag-over");
     if(dragFrom===null||dragFrom===i)return;

     const moved=map.order.splice(dragFrom,1)[0];
     map.order.splice(i,0,moved);
     dragFrom=null;
     save();
     renderMap(i);
   });

   row.addEventListener("dragend",()=>{
     row.classList.remove("dragging","drag-over");
     dragFrom=null;
   });
 });
}

/* ================= RENDER MAP ================= */
function renderMap(animateIndex){
 const map=state.maps[state.currentMap];
 const lockBtn=document.getElementById("lockBtn");
 lockBtn.className="btn "+(map.locked?"btn-unlock":"btn-lock");
 lockBtn.innerText=map.locked?"UNLOCK":"LOCK";

 const tbody=document.getElementById("mapTable");
 tbody.innerHTML="";
 map.order.forEach((t,i)=>{
   const p=point(i);
   const k=map.kill[t];
   const tr=document.createElement("tr");
   tr.className="drag-row"+(i===animateIndex?" drop-animate":"");
   tr.innerHTML=`
    <td><span class="drag-handle ${map.locked?"disabled":""}">â‰¡</span> ${i+1}</td>
    <td class="team">${t}</td>
    <td>${i===0?'<span class="badge wwcd">WWCD</span>':""}</td>
    <td>${p}</td>
    <td onclick="${map.locked?"":"openKill('"+t+"')"}">
      ${k===null?'<span class="kill-plain">0</span>':'<span class="badge kill">'+k+'</span>'}
    </td>
    <td>${p+(k||0)}</td>`;
   tbody.appendChild(tr);
 });
 enableDrag();
 renderAll();
}

/* ================= ALL STANDING ================= */
function renderAll(){
 const agg={}; teams.forEach(t=>agg[t]={w:0,p:0,k:0});
 Object.values(state.maps).forEach(m=>{
   if(m.locked){
     m.order.forEach((t,i)=>{
       agg[t].p+=point(i);
       if(i===0)agg[t].w++;
       if(m.kill[t])agg[t].k+=m.kill[t];
     });
   }
 });
 const sorted=[...teams].sort((a,b)=>{
   const A=agg[a],B=agg[b];
   return (B.p+B.k)-(A.p+A.k);
 });
 const tb=document.getElementById("allTable");
 tb.innerHTML="";
 sorted.forEach((t,i)=>{
   const A=agg[t];
   tb.innerHTML+=`
    <tr>
      <td>${i+1}</td>
      <td class="team">${t}</td>
      <td>${A.w}</td>
      <td>${A.p}</td>
      <td>${A.k}</td>
      <td>${A.p+A.k}</td>
    </tr>`;
 });
}

/* ================= KILL ================= */
let currentTeam=null,selectedKill=null;
function openKill(t){
 currentTeam=t;
 selectedKill=null;
 const g=document.getElementById("killGrid");
 g.innerHTML="";
 for(let i=0;i<=34;i++){
   const d=document.createElement("div");
   d.innerText=i;
   d.onclick=()=>{
     document.querySelectorAll(".kill-grid div").forEach(x=>x.classList.remove("active"));
     d.classList.add("active");
     selectedKill=i;
   };
   g.appendChild(d);
 }
 document.getElementById("killPopup").style.display="flex";
}
function saveKill(){
 if(currentTeam===null)return;
 state.maps[state.currentMap].kill[currentTeam]=selectedKill;
 save();
 closeKill();
 renderMap();
}
function closeKill(){
 document.getElementById("killPopup").style.display="none";
}

/* ================= EXPORT / IMPORT ================= */
function exportData(){
 const blob=new Blob([JSON.stringify(state,null,2)],{type:"application/json"});
 const a=document.createElement("a");
 a.href=URL.createObjectURL(blob);
 a.download="hswp-data.json";
 a.click();
}
function importData(){
 document.getElementById("importFile").click();
}
document.getElementById("importFile").addEventListener("change",e=>{
 const file=e.target.files[0];
 if(!file)return;
 const r=new FileReader();
 r.onload=()=>{
   if(confirm("Import akan gantikan semua data. Teruskan?")){
     state=JSON.parse(r.result);
     save();
     renderMap();
   }
 };
 r.readAsText(file);
});

/* ================= INIT ================= */
switchMap(state.currentMap);
</script>

</body>
</html>
